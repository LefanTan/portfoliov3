FROM node:16-alpine

WORKDIR /src

ADD package.json /src

ARG KEY
ARG SECRET

ARG DB_HOST
ARG DB_CLIENT
ARG DB_PORT
ARG DB_DATABASE
ARG DB_USER
ARG DB_PASSWORD

ARG ADMIN_EMAIL
ARG ADMIN_PASSWORD

ENV KEY ${KEY}
ENV SECRET ${SECRET}

ENV DB_HOST ${DB_HOST}
ENV DB_CLIENT ${DB_CLIENT}
ENV DB_PORT ${DB_PORT}
ENV DB_DATABASE ${DB_DATABASE}
ENV DB_USER ${DB_USER}
ENV DB_PASSWORD ${DB_PASSWORD}

ENV ADMIN_EMAIL ${ADMIN_EMAIL}
ENV ADMIN_PASSWORD ${ADMIN_PASSWORD}
ENV LOG_LEVEL 'debug'

RUN npm install

CMD ["npm", "run", "start"]